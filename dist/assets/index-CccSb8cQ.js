const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BK6I7RHo.js","assets/index-RD9we72E.js","assets/index-DPqrZ0d_.css","assets/parseSignature-htMp1C1b.js","assets/localBatchGatewayRequest-B8ZMCTWq.js","assets/secp256k1-Cd5VE8gT.js","assets/hashTypedData-COJ0TfZW.js","assets/index-DTXrUfXs.js","assets/index-My90LZL7.js","assets/index-D9Jch6-M.js"])))=>i.map(i=>d[i]);
import{d9 as y,bq as p,aW as g,da as _,c1 as m,b2 as l,db as v,dc as w,co as b}from"./index-RD9we72E.js";import{dd as S}from"./index-RD9we72E.js";function P(u={}){let h,s,o,c;return y(i=>({id:"baseAccount",name:"Base Account",rdns:"app.base.account",type:"baseAccount",async connect({chainId:e,withCapabilities:t}={}){try{const n=await this.getProvider(),a=(await n.request({method:"eth_requestAccounts",params:[]})).map(d=>p(d));s||(s=this.onAccountsChanged.bind(this),n.on("accountsChanged",s)),o||(o=this.onChainChanged.bind(this),n.on("chainChanged",o)),c||(c=this.onDisconnect.bind(this),n.on("disconnect",c));let r=await this.getChainId();return e&&r!==e&&(r=(await this.switchChain({chainId:e}).catch(f=>{if(f.code===l.code)throw f;return{id:r}}))?.id??r),{accounts:t?a.map(d=>({address:d,capabilities:{}})):a,chainId:r}}catch(n){throw/(user closed modal|accounts received is empty|user denied account|request rejected)/i.test(n.message)?new l(n):n}},async disconnect(){const e=await this.getProvider();s&&(e.removeListener("accountsChanged",s),s=void 0),o&&(e.removeListener("chainChanged",o),o=void 0),c&&(e.removeListener("disconnect",c),c=void 0),e.disconnect()},async getAccounts(){return(await(await this.getProvider()).request({method:"eth_accounts"})).map(t=>p(t))},async getChainId(){const t=await(await this.getProvider()).request({method:"eth_chainId"});return Number(t)},async getProvider(){if(!h){const e=typeof u.preference=="string"?{options:u.preference}:{...u.preference,options:u.preference?.options??"all"},{createBaseAccountSDK:t}=await v(async()=>{const{createBaseAccountSDK:a}=await import("./index-BK6I7RHo.js");return{createBaseAccountSDK:a}},__vite__mapDeps([0,1,2,3,4,5,6]));h=t({...u,appChainIds:i.chains.map(a=>a.id),preference:e}).getProvider()}return h},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:e,chainId:t}){const n=i.chains.find(r=>r.id===t);if(!n)throw new g(new _);const a=await this.getProvider();try{return await a.request({method:"wallet_switchEthereumChain",params:[{chainId:m(n.id)}]}),n}catch(r){if(r.code===4902)try{let d;e?.blockExplorerUrls?d=e.blockExplorerUrls:d=n.blockExplorers?.default.url?[n.blockExplorers?.default.url]:[];let f;e?.rpcUrls?.length?f=e.rpcUrls:f=[n.rpcUrls.default?.http[0]??""];const A={blockExplorerUrls:d,chainId:m(t),chainName:e?.chainName??n.name,iconUrls:e?.iconUrls,nativeCurrency:e?.nativeCurrency??n.nativeCurrency,rpcUrls:f};return await a.request({method:"wallet_addEthereumChain",params:[A]}),n}catch(d){throw new l(d)}throw new g(r)}},onAccountsChanged(e){e.length===0?this.onDisconnect():i.emitter.emit("change",{accounts:e.map(t=>p(t))})},onChainChanged(e){const t=Number(e);i.emitter.emit("change",{chainId:t})},async onDisconnect(e){i.emitter.emit("disconnect");const t=await this.getProvider();s&&(t.removeListener("accountsChanged",s),s=void 0),o&&(t.removeListener("chainChanged",o),o=void 0),c&&(t.removeListener("disconnect",c),c=void 0)}}))}C.type="safe";function C(u={}){const{shimDisconnect:h=!1}=u;let s,o;return y(c=>({id:"safe",name:"Safe",type:C.type,async connect({withCapabilities:i}={}){const e=await this.getProvider();if(!e)throw new w;const t=await this.getAccounts(),n=await this.getChainId();return o||(o=this.onDisconnect.bind(this),e.on("disconnect",o)),h&&await c.storage?.removeItem("safe.disconnected"),{accounts:i?t.map(a=>({address:a,capabilities:{}})):t,chainId:n}},async disconnect(){const i=await this.getProvider();if(!i)throw new w;o&&(i.removeListener("disconnect",o),o=void 0),h&&await c.storage?.setItem("safe.disconnected",!0)},async getAccounts(){const i=await this.getProvider();if(!i)throw new w;return(await i.request({method:"eth_accounts"})).map(p)},async getProvider(){if(typeof window<"u"&&window?.parent!==window){if(!s){const{default:e}=await v(async()=>{const{default:r}=await import("./index-DTXrUfXs.js");return{default:r}},__vite__mapDeps([7,8,1,2,6])),t=new e(u),n=await b(()=>t.safe.getInfo(),{timeout:u.unstable_getInfoTimeout??10});if(!n)throw new Error("Could not load Safe information");const a=await(async()=>{const r=await v(()=>import("./index-D9Jch6-M.js").then(d=>d.i),__vite__mapDeps([9,1,2,8]));return typeof r.SafeAppProvider!="function"&&typeof r.default.SafeAppProvider=="function"?r.default.SafeAppProvider:r.SafeAppProvider})();s=new a(n,t)}return s}},async getChainId(){const i=await this.getProvider();if(!i)throw new w;return Number(i.chainId)},async isAuthorized(){try{return h&&await c.storage?.getItem("safe.disconnected")?!1:!!(await this.getAccounts()).length}catch{return!1}},onAccountsChanged(){},onChainChanged(){},onDisconnect(){c.emitter.emit("disconnect")}}))}export{P as baseAccount,S as injected,C as safe};
